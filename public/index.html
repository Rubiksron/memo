<!DOCTYPE html>
  <html>
      <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/css/pages/clientside.css">
        <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Sen&display=swap" rel="stylesheet">
        <link rel="icon" type="image/png" href="../css/images/favicon-bear.png" />
      </head>
      <body>
        
        <h2>Chore Bear Log-in</h2>

        <form action="/checkPassword" method="post" id="choreBearLogin">
          <div id="showLogout"></div>
          <div class="container">
            <label><b>Username</b></label>
            <input type="text" placeholder="enter username" name="user" id="user" required>
            <label><b>Password</b></label>
            <input type="password" placeholder="enter password" name="password" id="password" required>
            <button>Log-in</button>
            <label>
              <input class="rememberMeInputBox" type="checkbox" checked="checked" name="remember"> Remember me
            </label>
          </div>
        </form>

        <button onclick="logIn()">Log In With Facebook</button>

        <form id="logoutButtonForm">
          <button id="logoutButton">Log-out</button>
        </form>

        <div id="createAccountDiv">
          <h2>Create New Account</h2>
          <form id="creatAccountForm" action="/createAccount" method="get">
            <button id="createAccountButton">Create account</button>
          </form>
        </div>

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <script src="clientside.js"></script>
      <script>
        var person = { userID: "", name: "", accessToken: "", picture: "", email: ""};

        function logIn() {
          FB.login(function(response) {
            if( response.status == "connected") {
              person.userID = response.authResponse.userID;
              person.accessToken = response.authResponse.accessToken;
              FB.api('/me?fields=id,name,email,picture.type(large)', function(userData) {
                person.name = userData.name;
                person.picture = userData.picture.data.url;

                $.ajax({
                  url: "index.html",
                  method: "GET",
                  data: person,
                  dataType: 'text',
                  success: function(serverResponse) {
                    if(serverResponse == "success") {
                      console.log('success!!')
                      window.location = "index.html"
                    }
                  }
                })
              })
            }
            console.log(response);
          }, { scope: 'public_profile'})
        }
        window.fbAsyncInit = function() {
          FB.init({
            appId            : '163257698356185',
            autoLogAppEvents : true,
            xfbml            : true,
            version          : 'v6.0'
          });
        };
      </script>
      <script async defer src="https://connect.facebook.net/en_US/sdk.js"></script>
          
    </body>
</html>
